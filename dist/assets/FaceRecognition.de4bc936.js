import{d as a,I as e,r as s,K as l,w as t,i,h as n,g as u,N as c,F as r,z as o,O as v,P as d,o as p,k as g,Q as m,V as f}from"./vendor.23c62718.js";/* empty css              *//* empty css              */import{_ as w}from"./UploadButton.vue_vue&type=script&setup=true&lang.5a821b96.js";import{n as b,l as h,u as j,M as y,T as F,S as _,v as x,D as M,b as U}from"./FaceMatcher.9cf7eaf3.js";import{m as k,r as z}from"./resizeResults.7ec8b892.js";import{d as D}from"./detectFaces.dcb5ab79.js";v("data-v-217c7038");const S=g(" 更换图片org： "),L=g(" 更换图片det： "),B=g(" 选择算法模型 "),C={class:"see"},I={class:"org"},R={class:"det"};d();var T=a({setup(a){const v=e("loading"),d=s([]),g=s([]),T=s("ssdMobilenetv1"),E=s({}),K=s(null),N=s(),O=s(),P=s(),Q=s(),V=["ssdMobilenetv1","tinyFaceDetector","mtcnn"],q=async()=>{switch(v.startLoading("模块资源加载中"),await b[T.value].loadFromUri("/models"),await h("/models"),await j("/models"),v.stopLoading(),T.value){case"ssdMobilenetv1":E.value=new _({minConfidence:.5});break;case"tinyFaceDetector":E.value=new F({inputSize:512,scoreThreshold:.5});break;case"mtcnn":E.value=new y({minFaceSize:20,scaleFactor:.709})}},A=async(a,e,s)=>{if(!K.value&&"det"===s)return;const l=await D(a,E.value).withFaceLandmarks().withFaceDescriptors();if(!l.length)return void(K.value=null);"org"===s&&(K.value=await new x(l)),k(e,a);z(l,a).forEach((({detection:a,descriptor:l})=>{let t=K.value.findBestMatch(l),i="org"===s?t.label:t.toString();new M(a.box,{label:i}).draw(e)}))};l((async()=>{await q(),await A(N.value,O.value,"org"),A(P.value,Q.value,"det")})),t(T,(async()=>{await q(),await A(N.value,O.value,"org"),A(P.value,Q.value,"det")}));const G=async(a,e,s)=>{if(!a.length)return;const l=await U(a[0]);e.src=l.src,s.getContext("2d").clearRect(0,0,s.width,s.height)};return t(d,(async a=>{await G(a,N.value,O.value),await A(N.value,O.value,"org"),A(P.value,Q.value,"det")})),t(g,(async a=>{await G(a,P.value,Q.value),A(P.value,Q.value,"det")})),(a,e)=>{const s=m,l=f,t=o;return p(),i(r,null,[n(t,null,{default:u((()=>[n(s,null,{default:u((()=>[S,n(w,{"file-list":d.value,"onUpdate:file-list":e[0]||(e[0]=a=>d.value=a),accept:"image/png, image/jpeg"},null,8,["file-list"])])),_:1}),n(s,null,{default:u((()=>[L,n(w,{"file-list":g.value,"onUpdate:file-list":e[1]||(e[1]=a=>g.value=a),accept:"image/png, image/jpeg"},null,8,["file-list"])])),_:1}),n(s,null,{default:u((()=>[B,n(l,{options:V,value:T.value,"onUpdate:value":e[2]||(e[2]=a=>T.value=a)},null,8,["value"])])),_:1})])),_:1}),c("div",C,[c("div",I,[c("img",{ref:N,src:"/assets/xxm03.95680260.jpg"},null,512),c("canvas",{ref:O},null,512)]),c("div",R,[c("img",{ref:P,src:"/assets/cp02.cb35de09.jpg"},null,512),c("canvas",{ref:Q},null,512)])])],64)}}});T.__scopeId="data-v-217c7038";export{T as default};
