import{d as e,I as a,r as t,K as l,w as s,i,h as n,g as c,N as r,z as o,o as u,k as d,Q as v,V as m}from"./vendor.51cee63a.js";/* empty css              *//* empty css              */import{_ as p}from"./xxm03.d0b2a9e7.js";import{_ as f}from"./UploadButton.vue_vue&type=script&setup=true&lang.d580cfdf.js";import{n as w,l as g,u as h,M as b,T as j,S as F,v as y,D as x,b as _}from"./FaceMatcher.9cf7eaf3.js";import{m as M,r as C}from"./resizeResults.7ec8b892.js";import{d as E}from"./detectFaces.dcb5ab79.js";const k={class:"face_recognition_more"},D=d(" 更换图片org： "),L=d(" 更换图片det： "),U=d(" 选择算法模型 "),z={class:"see"},B={class:"org"},S=r("hr",null,null,-1);var T=e({setup(e){const d=a("loading"),T=t([]),I=t([]),N=t("ssdMobilenetv1"),R=t({}),H=t(null),K=t(),Q=t(),V=t(),q=["ssdMobilenetv1","tinyFaceDetector","mtcnn"],A=async()=>{const e=await E(K.value,R.value).withFaceLandmarks().withFaceDescriptors();if(!e.length)return void(H.value=null);H.value=await new y(e),M(Q.value,K.value);C(e,K.value).forEach((({detection:e,descriptor:a})=>{let{label:t}=H.value.findBestMatch(a);new x(e.box,{label:t}).draw(Q.value)}))},G=async(e=0,a="/images/cp03.jpg")=>{if(!H.value)return;let t=document.createElement("img");t.id="detImg"+e,t.src=a;let l=document.createElement("canvas");l.id="detCanvas"+e;let s=document.createElement("div");s.className="det",s.appendChild(t),s.appendChild(l),V.value.appendChild(s);const i=await E(t,R.value).withFaceLandmarks().withFaceDescriptors();if(!i.length)return;M(l,t);C(i,t).forEach((({detection:e,descriptor:a})=>{let t=H.value.findBestMatch(a).toString();new x(e.box,{label:t}).draw(l)}))},J=async()=>{switch(d.startLoading("模块资源加载中"),await w[N.value].loadFromUri("/models"),await g("/models"),await h("/models"),d.stopLoading(),N.value){case"ssdMobilenetv1":R.value=new F({minConfidence:.5});break;case"tinyFaceDetector":R.value=new j({inputSize:512,scoreThreshold:.5});break;case"mtcnn":R.value=new b({minFaceSize:20,scaleFactor:.709})}await A(),await G()};return l(J),s(N,(async()=>{await J(),V.value.innerHTML=""})),s(T,(async e=>{e.length&&_(e[0]).then((async e=>{K.value.src=e.src,Q.value.getContext("2d").clearRect(0,0,Q.value.width,Q.value.height),await A(),await G()}))})),s(I,(e=>{e.forEach((async(e,a)=>{const t=await _(e);await G(a,t.src)}))})),(e,a)=>{const t=v,l=m,s=o;return u(),i("div",k,[n(s,null,{default:c((()=>[n(t,null,{default:c((()=>[D,n(f,{"file-list":T.value,"onUpdate:file-list":a[0]||(a[0]=e=>T.value=e),accept:"image/png, image/jpeg"},null,8,["file-list"])])),_:1}),n(t,null,{default:c((()=>[L,n(f,{multiple:!0,"file-list":I.value,"onUpdate:file-list":a[1]||(a[1]=e=>I.value=e),accept:"image/png, image/jpeg"},null,8,["file-list"])])),_:1}),n(t,null,{default:c((()=>[U,n(l,{options:q,value:N.value,"onUpdate:value":a[2]||(a[2]=e=>N.value=e)},null,8,["value"])])),_:1})])),_:1}),r("div",z,[r("div",B,[r("img",{ref:K,src:p},null,512),r("canvas",{ref:Q},null,512)]),S,r("div",{ref:V,id:"detBox"},null,512)])])}}});export{T as default};
