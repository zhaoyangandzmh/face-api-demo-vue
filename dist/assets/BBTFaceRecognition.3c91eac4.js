import{d as a,I as e,r as s,K as t,w as n,i as l,h as i,g as c,N as o,F as r,j as m,z as u,O as d,P as v,o as x,t as f,k as g,Q as p,V as b}from"./vendor.51cee63a.js";/* empty css              *//* empty css              */import{_ as w}from"./xxm03.d0b2a9e7.js";import{_ as h}from"./UploadButton.vue_vue&type=script&setup=true&lang.d580cfdf.js";import{n as y,l as j,u as F,M as _,T as k,S as M,D as z,w as C,L as D,v as L,b as S}from"./FaceMatcher.9cf7eaf3.js";import{f as U}from"./fetchImage.05f71b13.js";import{m as I,r as B}from"./resizeResults.7ec8b892.js";import{d as P}from"./detectFaces.dcb5ab79.js";d("data-v-289b6547");const R={class:"face_recognition_library"},T=g(" 匹配图选择： "),E=g(" 选择算法模型 "),K=o("h3",null,"匹配图：",-1),N={class:"target"},O=o("h3",null,"样本库：",-1),Q=["textContent"],V={class:"pic"},q=["src"];v();var A=a({setup(a){const d=e("loading"),v=s(),g=s(),A=s(),G=s("ssdMobilenetv1"),H=s({}),J=["ssdMobilenetv1","tinyFaceDetector","mtcnn"],W=s([{name:"欣小萌",img:["images/xxm/face/xxm01.png","images/xxm/face/xxm02.png","images/xxm/face/xxm03.png","images/xxm/face/xxm04.png"]},{name:"旭旭宝宝",img:["images/xxbb/face/xxbb01.png","images/xxbb/face/xxbb02.png","images/xxbb/face/xxbb03.png","images/xxbb/face/xxbb04.png"]}]),X=s(),Y=async()=>{switch(d.startLoading("模块资源加载中"),await y[G.value].loadFromUri("/models"),await j("/models"),await F("/models"),d.stopLoading(),G.value){case"ssdMobilenetv1":H.value=new M({minConfidence:.5});break;case"tinyFaceDetector":H.value=new k({inputSize:512,scoreThreshold:.5});break;case"mtcnn":H.value=new _({minFaceSize:20,scaleFactor:.709})}await(async()=>{const a=await Promise.all(W.value.map((async a=>{let e=[];for(let s of a.img){const a=await U(s);e.push(await C(a))}return new D(a.name,e)})));X.value=new L(a)})()},Z=async()=>{const a=await P(g.value,H.value).withFaceLandmarks().withFaceDescriptors();I(A.value,g.value);B(a,g.value).forEach((({detection:a,descriptor:e})=>{const s=X.value.findBestMatch(e).toString();new z(a.box,{label:s}).draw(A.value)}))};return t((async()=>{await Y(),Z()})),n(v,(async a=>{if(!a.length)return;const e=await S(a[0]);g.value.src=e.src,A.value.getContext("2d").clearRect(0,0,A.value.width,A.value.height),Z()})),n(G,(async()=>{await Y(),Z()})),(a,e)=>{const s=p,t=b,n=u;return x(),l("div",R,[i(n,null,{default:c((()=>[i(s,null,{default:c((()=>[T,i(h,{"file-list":v.value,"onUpdate:file-list":e[0]||(e[0]=a=>v.value=a),accept:"image/png, image/jpeg"},null,8,["file-list"])])),_:1}),i(s,null,{default:c((()=>[E,i(t,{options:J,value:G.value,"onUpdate:value":e[1]||(e[1]=a=>G.value=a)},null,8,["value"])])),_:1})])),_:1}),K,o("div",N,[o("img",{ref:g,src:w},null,512),o("canvas",{ref:A},null,512)]),O,(x(!0),l(r,null,m(W.value,((a,e)=>(x(),l("div",{key:e},[o("span",{style:{color:"#42b983"},textContent:f(a.name)},null,8,Q),o("div",V,[(x(!0),l(r,null,m(a.img,(a=>(x(),l("img",{key:a,src:a},null,8,q)))),128))])])))),128))])}}});A.__scopeId="data-v-289b6547";export{A as default};
